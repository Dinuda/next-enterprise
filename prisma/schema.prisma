generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl         = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING") // used for migrations
}

model User {
  id              String        @id @default(uuid())
  email           String        @unique
  phone           String        @unique
  name            String
  organization    Organization  @relation(fields: [organizationId], references: [id])
  organizationId  String
  students        StudentUser[] // Renamed 'users' to 'students'
  accountVerified Boolean       @default(false)
  otp             OTP?
}

model OTP {
  id         String    @id @default(uuid())
  code       String    @unique
  user       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId     String    @unique
  updatedAt  DateTime  @updatedAt
  expiresAt  DateTime
  verifiedAt DateTime?
}

model StudentUser {
  id      String @id @default(uuid())
  name    String
  country String
  address String
  dateOfBirth     DateTime
  user    User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId  String
}

model Organization {
  id    String @id @default(uuid())
  name  String
  users User[] // Renamed 'parentUser' to 'users'
}
